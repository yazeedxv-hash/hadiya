<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù‡Ø¯ÙŠØ©</title>
  <meta name="description" content="Ù‡Ø¯ÙŠØ©: Ù…ÙˆÙ‚Ø¹ Ø¨Ø³ÙŠØ· Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙÙ‡Ø¯ÙŠÙ† Ø¨Ø³Ø±Ù‘ÙŠØ© (ÙÙƒØ±Ø© Ù…Ø«Ù„ Secret Santa Ø¨Ø¯ÙˆÙ† Ø·Ø§Ø¨Ø¹ ÙƒØ±ÙŠØ³Ù…Ø§Ø³)." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1220;
      --card:#121a2b;
      --muted:#9aa7bd;
      --text:#eef3ff;
      --accent:#7c5cff;
      --accent2:#22c55e;
      --danger:#ef4444;
      --border:rgba(255,255,255,.08);
      --shadow: 0 12px 35px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Tajawal", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 80% -20%, rgba(124,92,255,.35), transparent 55%),
                  radial-gradient(900px 700px at 10% 0%, rgba(34,197,94,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .wrap{width:min(980px, 100%)}
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo{
      width:48px;height:48px;border-radius:14px;
      background: linear-gradient(135deg, rgba(124,92,255,.95), rgba(34,197,94,.75));
      box-shadow: var(--shadow);
      display:grid;place-items:center;
      font-size:22px;
    }
    h1{margin:0;font-weight:800;letter-spacing:.2px}
    .subtitle{margin:4px 0 0;color:var(--muted);font-size:14px}
    .pill{
      border:1px solid var(--border);
      padding:10px 12px;
      border-radius:999px;
      color:var(--muted);
      font-size:13px;
      display:flex;
      gap:8px;
      align-items:center;
      background: rgba(255,255,255,.03);
    }
    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
      header{flex-direction:column; align-items:flex-start}
    }
    .card{
      background: rgba(18,26,43,.88);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .head{
      padding:16px 18px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .card .head h2{
      margin:0;
      font-size:16px;
      font-weight:800;
    }
    .card .body{padding:16px 18px}
    label{display:block;margin:0 0 8px;color:var(--muted);font-size:13px}
    textarea, input{
      width:100%;
      background: rgba(255,255,255,.04);
      color:var(--text);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding:12px 12px;
      font-family:inherit;
      font-size:15px;
      outline:none;
    }
    textarea{min-height:190px; resize:vertical; line-height:1.75}
    input{height:44px}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px}
    @media (max-width:600px){ .row{grid-template-columns:1fr} }
    .btns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    button{
      border:0;
      border-radius: 12px;
      padding: 11px 14px;
      font-family:inherit;
      font-weight:800;
      cursor:pointer;
      transition: transform .05s ease, filter .15s ease;
      color: #0b1220;
      background: linear-gradient(135deg, var(--accent), #a78bfa);
    }
    button:active{transform:scale(.99)}
    button.secondary{
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid var(--border);
      font-weight:700;
    }
    button.danger{
      background: rgba(239,68,68,.12);
      color: #fecaca;
      border:1px solid rgba(239,68,68,.28);
      font-weight:800;
    }
    .hint{margin-top:10px;color:var(--muted);font-size:13px;line-height:1.7}
    .tiny{font-size:12px;color:var(--muted)}
    .badge{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
    }
    .results{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:8px;
    }
    .result{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px 12px;
      background: rgba(255,255,255,.03);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
    }
    .who{font-weight:800}
    .to{color:var(--muted); margin-top:4px}
    .copy{
      white-space:nowrap;
      font-weight:800;
      background: rgba(34,197,94,.12);
      border:1px solid rgba(34,197,94,.28);
      color:#bbf7d0;
    }
    .msg{
      margin-top:10px;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      line-height:1.7;
    }
    .msg strong{color:var(--text)}
    .footer{
      margin-top:14px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      color:var(--muted);
      font-size:12px;
    }
    a{color:#c7d2fe; text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">ğŸ</div>
        <div>
          <h1>Ù‡Ø¯ÙŠØ©</h1>
          <div class="subtitle">ÙˆØ²Ù‘Ø¹ Ø§Ù„Ù…ÙÙ‡Ø¯ÙŠÙ† Ø¨Ø³Ø±Ù‘ÙŠØ© â€” Ù†ÙØ³ Ù…ÙÙ‡ÙˆÙ… Secret Santa Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ† Ø·Ø§Ø¨Ø¹ ÙƒØ±ÙŠØ³Ù…Ø§Ø³</div>
        </div>
      </div>
      <div class="pill" title="ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØªÙ… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ ÙÙ‚Ø·">
        <span>ğŸ”’</span>
        <span>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªÙØ±Ø³Ù„ Ù„Ø£ÙŠ Ø³ÙŠØ±ÙØ±</span>
      </div>
    </header>

    <div class="grid">
      <!-- Left: Input -->
      <section class="card">
        <div class="head">
          <h2>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø±Ø¹Ø©</h2>
          <span class="badge">Ø­Ø¯ Ø£Ø¯Ù†Ù‰: 3 Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</span>
        </div>
        <div class="body">
          <label for="eventName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <input id="eventName" placeholder="Ù…Ø«Ø§Ù„: Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„Ù…ÙƒØªØ¨ / ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ù‚Ø±ÙˆØ¨ / Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±" />

          <div class="row">
            <div>
              <label for="budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <input id="budget" placeholder="Ù…Ø«Ø§Ù„: 100 Ø±ÙŠØ§Ù„" />
            </div>
            <div>
              <label for="notes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <input id="notes" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù…Ù†ÙˆØ¹ Ù‡Ø¯Ø§ÙŠØ§ Ù…Ø²Ø§Ø­ Ø«Ù‚ÙŠÙ„Ø© ğŸ˜„" />
            </div>
          </div>

          <div style="margin-top:12px">
            <label for="names">Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ (ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø±)</label>
            <textarea id="names" placeholder="Ø³Ù„ÙŠÙ…Ø§Ù†&#10;ØªØ±ÙƒÙŠ&#10;Ù†ÙˆØ±Ø©&#10;Ø³Ø§Ø±Ø©"></textarea>
          </div>

          <div class="btns">
            <button id="btnDraw" type="button">ÙˆØ²Ù‘Ø¹ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§</button>
            <button id="btnShuffleOnly" class="secondary" type="button">Ø®Ù„Ø· ÙÙ‚Ø·</button>
            <button id="btnClear" class="danger" type="button">Ù…Ø³Ø­</button>
          </div>

          <div class="hint">
            âœ… Ø¨Ø¹Ø¯ Ø§Ù„ØªÙˆØ²ÙŠØ¹ØŒ ÙƒÙ„ Ø´Ø®Øµ ÙŠØ¶ØºØ· Ø¹Ù„Ù‰ Ø§Ø³Ù…Ù‡ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† ÙˆÙŠØ¸Ù‡Ø± Ù„Ù‡ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙ‡Ø¯ÙŠÙ‡.  
            <br>ğŸ’¡ ØªÙ‚Ø¯Ø± ØªØ³ØªØ®Ø¯Ù… Ø²Ø± "Ù†Ø³Ø®" Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ø´Ø®Øµ Ø¨Ø´ÙƒÙ„ Ø®Ø§Øµ (ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø«Ù„Ù‹Ø§).
          </div>
        </div>
      </section>

      <!-- Right: Reveal -->
      <section class="card">
        <div class="head">
          <h2>Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø´ÙƒÙ„ Ø®Ø§Øµ</h2>
          <span class="badge">Ø¹Ø±Ø¶ ÙØ±Ø¯ÙŠ</span>
        </div>
        <div class="body">
          <label for="chooser">Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒ</label>
          <select id="chooser" style="width:100%;height:44px;border-radius:12px;background:rgba(255,255,255,.04);color:var(--text);border:1px solid var(--border);padding:10px 12px;font-family:inherit;font-size:15px;outline:none">
            <option value="">â€” Ù„Ø§Ø²Ù… ØªØ³ÙˆÙŠ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø£ÙˆÙ„ â€”</option>
          </select>

          <div id="privateBox" class="msg" style="display:none"></div>

          <div class="results" id="publicResults" style="display:none"></div>

          <div class="footer">
            <div>Â© <span id="year"></span> Ù‡Ø¯ÙŠØ©</div>
            <div class="tiny">Tip: Ø§ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø¹Ù„Ù‰ Ø¬ÙˆØ§Ù„Ùƒ ÙˆØ®Ù„ ÙƒÙ„ Ø´Ø®Øµ ÙŠØ®ØªØ§Ø± Ø§Ø³Ù…Ù‡ Ø¨Ù†ÙØ³Ù‡.</div>
          </div>
        </div>
      </section>
    </div>
  </div>

<script>
(function(){
  const $ = (id) => document.getElementById(id);

  const btnDraw = $("btnDraw");
  const btnShuffleOnly = $("btnShuffleOnly");
  const btnClear = $("btnClear");

  const namesEl = $("names");
  const chooser = $("chooser");
  const privateBox = $("privateBox");
  const publicResults = $("publicResults");

  const eventName = $("eventName");
  const budget = $("budget");
  const notes = $("notes");

  $("year").textContent = new Date().getFullYear();

  let assignment = null; // { giver: receiver }

  function normalizeNames(text){
    return text
      .split("\n")
      .map(s => s.trim())
      .filter(Boolean)
      .filter((v, i, a) => a.indexOf(v) === i); // remove duplicates
  }

  function shuffle(array){
    for (let i = array.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function buildCycle(names){
    // Simple cycle: shuffled[i] -> shuffled[i+1], last -> first
    const shuffled = shuffle([...names]);
    const map = {};
    for (let i = 0; i < shuffled.length; i++){
      map[shuffled[i]] = shuffled[(i + 1) % shuffled.length];
    }
    return { shuffled, map };
  }

  function resetUI(){
    chooser.innerHTML = '<option value="">â€” Ù„Ø§Ø²Ù… ØªØ³ÙˆÙŠ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø£ÙˆÙ„ â€”</option>';
    privateBox.style.display = "none";
    privateBox.innerHTML = "";
    publicResults.style.display = "none";
    publicResults.innerHTML = "";
  }

  function renderChooser(names){
    chooser.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒâ€¦</option>';
    names.forEach(n => {
      const opt = document.createElement("option");
      opt.value = n;
      opt.textContent = n;
      chooser.appendChild(opt);
    });
  }

  function renderPrivate(giver){
    if (!assignment || !assignment.map[giver]) return;

    const receiver = assignment.map[giver];
    const title = (eventName.value || "").trim();
    const bud = (budget.value || "").trim();
    const note = (notes.value || "").trim();

    const lines = [];
    if (title) lines.push(`ğŸ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: ${title}`);
    if (bud) lines.push(`ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©: ${bud}`);
    if (note) lines.push(`ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø©: ${note}`);
    lines.push(`\n${giver}ØŒ Ø£Ù†Øª Ø±Ø§Ø­ ØªÙ‡Ø¯ÙŠ: ğŸ ${receiver}`);

    const shareText = lines.join("\n");

    privateBox.style.display = "block";
    privateBox.innerHTML = `
      <div><strong>${giver}</strong> â€” Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ø³Ø±Ù‘ÙŠØ©:</div>
      <div style="margin-top:8px;color:var(--text);font-weight:800">ğŸ Ø£Ù†Øª Ø±Ø§Ø­ ØªÙ‡Ø¯ÙŠ: ${receiver}</div>
      <div class="tiny" style="margin-top:8px">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ù‡Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥Ù„Ø§ Ù„Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø¹Ù†ÙŠ.</div>
      <div class="btns" style="margin-top:10px">
        <button class="copy" type="button" id="btnCopy">Ù†Ø³Ø® Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§</button>
        <button class="secondary" type="button" id="btnHide">Ø¥Ø®ÙØ§Ø¡</button>
      </div>
    `;

    $("btnCopy").onclick = async () => {
      try{
        await navigator.clipboard.writeText(shareText);
        $("btnCopy").textContent = "âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®";
        setTimeout(()=> $("btnCopy").textContent = "Ù†Ø³Ø® Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§", 1200);
      }catch(e){
        alert("Ù…Ø§ Ù‚Ø¯Ø±Øª Ø£Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. Ø¬Ø±Ù‘Ø¨ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ Ø£Ùˆ Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠÙ‹Ø§.");
      }
    };

    $("btnHide").onclick = () => {
      privateBox.style.display = "none";
      privateBox.innerHTML = "";
      chooser.value = "";
    };
  }

  function draw(){
    const names = normalizeNames(namesEl.value);
    if (names.length < 3){
      alert("Ø£Ø¯Ø®Ù„ 3 Ø£Ø³Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø±).");
      return;
    }

    assignment = buildCycle(names);

    resetUI();
    renderChooser(assignment.shuffled);

    // Optional: show full list of givers (not revealing receivers) â€” we keep it hidden by default.
    publicResults.style.display = "none";
  }

  function shuffleOnly(){
    const names = normalizeNames(namesEl.value);
    if (names.length < 2){
      alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø¹Ø´Ø§Ù† Ø£Ù‚Ø¯Ø± Ø£Ø®Ù„Ø·.");
      return;
    }
    const shuffled = shuffle([...names]);
    namesEl.value = shuffled.join("\n");
  }

  function clearAll(){
    if (!confirm("ØªØ¨ØºÙ‰ ØªÙ…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡ØŸ")) return;
    namesEl.value = "";
    eventName.value = "";
    budget.value = "";
    notes.value = "";
    assignment = null;
    resetUI();
  }

  btnDraw.addEventListener("click", draw);
  btnShuffleOnly.addEventListener("click", shuffleOnly);
  btnClear.addEventListener("click", clearAll);

  chooser.addEventListener("change", (e) => {
    const giver = e.target.value;
    if (!giver){ privateBox.style.display="none"; privateBox.innerHTML=""; return; }
    renderPrivate(giver);
  });

})();
</script>
</body>
</html>
